# プロジェクト固有の指示書（テンプレート）

このファイルは、新規プロジェクトで使用するプロジェクト固有の開発ルールのテンプレートです。

## 環境

| 環境       | プラットフォーム   | 説明                                 |
|------------|--------------------|------------------------------------|
| ローカル   | Docker Compose     | ローカル PC での開発                 |
| 本番       | Coolify on Pi4     | Raspberry Pi 4 (ARM64) にデプロイ   |

## 開発ルール

### 1. ビルド設定

- **Dockerfile を手動で書かない** - Nixpacks による自動ビルド検出に依存する
- 必要に応じて `nixpacks.toml` で Nixpacks 設定をカスタマイズ可能
- Coolify がビルドとデプロイプロセスを自動的に処理

### 2. データ永続化

- 永続データには**必ず Docker ボリュームを使用**する
- コンテナのファイルシステム内に永続データを保存しない
- ローカル開発用に `compose.yaml` でボリュームを定義

### 3. ロギング

- **すべてのログを stdout に出力** - ログファイルに書き込まない
- 可能な限り構造化ログ（JSON 形式）を使用
- Coolify と Docker が自動的に stdout/stderr をキャプチャ

### 4. 環境変数

- ローカル開発では `.env` ファイルを使用（`.env.example` からコピー）
- 本番環境では Coolify ダッシュボードで環境変数を設定
- `.env` ファイルをリポジトリにコミットしない

### 5. ポート設定

- デフォルトのアプリケーションポート: `3000`
- ローカル開発では Docker Compose でポートを公開
- 本番では Coolify がポートマッピングを処理

## アーキテクチャ概要

```
┌─────────────────┐     Git Push     ┌─────────────────┐
│   ローカル PC    │ ───────────────► │    GitHub       │
│ (Docker Compose)│                  │                 │
└─────────────────┘                  └────────┬────────┘
                                              │
                                              │ Webhook
                                              ▼
                                     ┌─────────────────┐
                                     │  Raspberry Pi 4 │
                                     │    (Coolify)    │
                                     └────────┬────────┘
                                              │
                                              │ Tailscale
                                              ▼
                                     ┌─────────────────┐
                                     │  メッシュネットワーク │
                                     │   (プライベート)   │
                                     └─────────────────┘
```

## 技術スタック

- **コンテナ化**: Docker / Docker Compose
- **ビルドツール**: Nixpacks
- **デプロイメント**: Coolify
- **ネットワーク**: Tailscale
- **ホスティング**: Raspberry Pi 4 (ARM64)

## AI アシスタント向けの注意事項

- ARM64 アーキテクチャを常に考慮する
- Coolify の自動化機能を活用する
- シンプルさを保つことを最優先する
- 手動設定より規約を優先する

---

**注意**: このファイルをプロジェクト固有の要件に合わせてカスタマイズしてください。
